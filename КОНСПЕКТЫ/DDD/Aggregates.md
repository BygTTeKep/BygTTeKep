Aggregate - это про границу согласованности.
Главная проблема которую она решает
> Как обеспечить бизнес инварианты без глобальных транзакций и блокировок

# Историческая проблема
до aggregates
- одна транзакция трогает 10-15 таблиц
- Куча FK
- cascading upodates
- deadlock'и
- деградация OLTP
DDD говорит
> Одна транзакция - один aggregate

# Aggregate Root
- Единственная точка входа
- Едиственный объект, доступный извне
# Что aggreate гарантирует
Внутри одного aggregate:
- Строгие инварианты
- Консистентность
- Транзакционность
Между aggregate'ами
- нет мгновенной консистентности
- только eventual consistency
# Типичные инварианты aggregate
Примеры:
- оплаченный заказ нельзя отменить
- сумма заказа - сумма позиций
- нельзя добавить товар в закрытый заказ
Все эти правила:
- живут внутри aggragate
- не в сервисах 
- не в бд
> один aggregate root не может жить в нескольких сервисах
# Пример выделения aggregate
1) Выпиши бизнес инварианты
2) Посмотри какие данные должны быть проверенны сразу
3) Это и есть граница aggregate
4) Все остальное - за пределами

>1) UL определяет aggregate
>2) aggregate определяет транзакцию
>3) транзакция определяет схему бд
>4) схема бд определяет производительность

Aggregate - это минимальная граница, внутри которой бизнес требует немедленной согласованности
