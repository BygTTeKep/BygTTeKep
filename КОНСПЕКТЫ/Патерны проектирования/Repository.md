# Какую проблему решает
repository решает проблему смешения доменной логики с деталями хранения данных
repository изолирует домен от способа хранения данных

---
# Симтомы
- бизнес логика
	- зависит от ORM
	- оперирует DTO/Entity из инфраструктуры
- сложные запросы разбросаны по сервисам
- доменные правила зависят от структуры БД
- сложно заменить БД/ORM/способ хранения

---
# Суть
- Repository - это коллекция аггрегатов
- он предоставляет методы для загрузки и скрывает детали хранения
- возвращает доменную модель, а не ORM-entitty
- принимает доменные объекты

---
# Ключевая идея
Домен работает с коллекциями обхектов, а не ORM-entity
Repository позволяет домену жумать в терминах
- findById
- Save
- remove
А не
- SELECT
- JOIN
- INDEX

---
# Когда оправдан
- используется DDD
- есть агрегаты/инварианты
- домен не должен знать про инфраструктуру
- нужна тестируемость, подъмена реализации
- сложные бизнес операции над данными

---
# Когда антипаттерн
- это просто thin wrapper над ORM
- возвращается ORM-entities, RAW DTO
- методы репозитория повторяют CRUD
- бизнес логика живет в сервисах, контроллерах